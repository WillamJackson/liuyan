<!--search.wxml-->
<view class="container">
  <!-- çŠ¶æ€æ å ä½ -->
  <view class="status-bar" style="height: {{statusBarHeight}}px;"></view>
  
  <!-- æœç´¢å¤´éƒ¨ -->
  <view class="search-header">
    <view class="search-box">
      <text class="search-icon">ğŸ”</text>
      <input class="search-input" placeholder="æœç´¢å†…å®¹æ ‡é¢˜..." value="{{searchKeyword}}" bindinput="onSearchInput" bindconfirm="onSearch" confirm-type="search" />
      <text class="voice-icon" wx:if="{{!searchKeyword}}" bindtap="startVoiceSearch">ğŸ¤</text>
      <text class="clear-icon" wx:else bindtap="clearSearch">âœ•</text>
    </view>
  </view>
  
  <!-- å†…å®¹åŒºåŸŸ -->
  <scroll-view class="content-area" scroll-y="true" enable-back-to-top="true" scroll-with-animation="true">
    <!-- æœç´¢ä¸ºç©ºæ—¶æ˜¾ç¤º -->
    <view wx:if="{{!searchKeyword && !isSearching}}" class="search-empty">
      <!-- çƒ­é—¨æœç´¢ -->
      <view class="section">
        <view class="section-title">ğŸ”¥ çƒ­é—¨æœç´¢</view>
        <view class="tag-list">
          <view class="tag" wx:for="{{hotTags}}" wx:key="*this" bindtap="searchByTag" data-tag="{{item}}">
            {{item}}
          </view>
        </view>
      </view>
      
      <!-- æœç´¢å†å² -->
      <view class="section" wx:if="{{searchHistory.length > 0}}">
        <view class="section-title">ğŸ•’ æœç´¢å†å²</view>
        <view class="history-list">
          <view class="history-item" wx:for="{{searchHistory}}" wx:key="*this">
            <text class="history-text" bindtap="searchByTag" data-tag="{{item}}">{{item}}</text>
            <text class="history-delete" bindtap="deleteHistory" data-index="{{index}}">âœ•</text>
          </view>
        </view>
      </view>
      
      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-state">
        <view class="empty-icon">ğŸ”</view>
        <view class="empty-text">è¾“å…¥å…³é”®è¯å¼€å§‹æœç´¢</view>
        <view class="empty-subtext">æ”¯æŒæ ‡é¢˜æ¨¡ç³Šæœç´¢</view>
      </view>
    </view>
    
    <!-- æœç´¢ç»“æœ -->
    <view wx:if="{{searchKeyword && searchResults.length > 0}}" class="search-results">
      <view class="result-count">æ‰¾åˆ° {{searchResults.length}} æ¡ç›¸å…³å†…å®¹</view>
      
      <view class="content-card" wx:for="{{searchResults}}" wx:key="id">
        <!-- å¡ç‰‡å¤´éƒ¨ -->
        <view class="content-header">
          <view class="content-type">{{item.typeIcon}} {{item.typeName}}</view>
          <view class="content-time">{{item.timeText}}</view>
        </view>
        
        <!-- æ ‡é¢˜ï¼ˆé«˜äº®å…³é”®è¯ï¼‰ -->
        <rich-text class="content-title" nodes="{{item.highlightTitle}}"></rich-text>
        
        <!-- æ­£æ–‡å†…å®¹ï¼ˆé«˜äº®å…³é”®è¯ï¼‰ -->
        <rich-text class="content-text" nodes="{{item.highlightContent}}"></rich-text>
        
        <!-- é“¾æ¥å¡ç‰‡ï¼ˆå¦‚æœæœ‰ï¼‰ -->
        <view class="link-card" wx:if="{{item.linkUrl}}" bindtap="openLink" data-url="{{item.linkUrl}}">
          <view class="link-icon">ğŸ”—</view>
          <view class="link-url">{{item.linkUrl}}</view>
        </view>
        
        <!-- åª’ä½“æ–‡ä»¶ç½‘æ ¼ -->
        <view class="media-grid" wx:if="{{item.mediaList && item.mediaList.length > 0}}">
          <view class="media-item" wx:for="{{item.mediaList}}" wx:for-item="media" wx:key="id" bindtap="previewImage" data-urls="{{item.mediaList}}" data-current="{{media.url}}">
            <image class="media-image" src="{{media.url}}" mode="aspectFill" lazy-load></image>
          </view>
        </view>
        
        <!-- åé¦ˆæ  -->
        <view class="reaction-bar">
          <view class="reactions">
            <view class="reaction-btn" wx:for="{{reactionTypes}}" wx:key="type" bindtap="toggleReaction" data-content-id="{{item.id}}" data-type="{{item.type}}">
              <text class="reaction-emoji">{{item.emoji}}</text>
              <text class="reaction-count">{{item.count > 0 ? item.count : ''}}</text>
            </view>
          </view>
          <view class="share-btn" bindtap="shareContent" data-item="{{item}}">
            <text>åˆ†äº«</text>
          </view>
        </view>
      </view>
    </view>
    
    <!-- æ— æœç´¢ç»“æœ -->
    <view wx:if="{{searchKeyword && searchResults.length === 0 && !isSearching}}" class="no-results">
      <view class="empty-icon">ğŸ˜”</view>
      <view class="empty-text">æ²¡æœ‰æ‰¾åˆ°ç›¸å…³å†…å®¹</view>
      <view class="empty-subtext">è¯•è¯•å…¶ä»–å…³é”®è¯å§</view>
    </view>
    
    <!-- æœç´¢ä¸­ -->
    <view wx:if="{{isSearching}}" class="searching">
      <view class="loading-icon">â³</view>
      <view class="loading-text">æœç´¢ä¸­...</view>
    </view>
  </scroll-view>
</view> 